const CACHE_NAME = 'site-cache-v1771765047';
const ASSETS_TO_CACHE = [
    "ads.txt",
    "bld/classes.jar.js",
    "bld/j2me.js",
    "bld/main-all.js",
    "bld/native.js",
    "bld/shumway.js",
    "certs/digicert_global_root.der",
    "certs/godaddy_class_2_ca.der",
    "certs/Makefile",
    "certs/_main.ks",
    "certs/_test.ks",
    "config/build.js",
    "config/default.js",
    "config/runtests.js",
    "config/urlparams.js",
    "img/ftu.png",
    "img/java-112.png",
    "img/java-128.png",
    "img/java-512.png",
    "img/java-56.png",
    "index.html",
    "index.js",
    "index1.js",
    "index2.html",
    "installer.html",
    "J2me PWA .zip",
    "jar/ftu.jar",
    "java/classes.jar",
    "java.png",
    "js/midi/loader.js",
    "kaiads.v5.min.js",
    "keymap.js",
    "libs/BenzAMRRecorder.js",
    "libs/compiled-method-cache.js",
    "libs/encoding.js",
    "libs/load.js",
    "libs/PicoAudio.js",
    "libs/promise-6.0.0.js",
    "libs/webaudio-tinysynth.js",
    "libs/webaudio.js",
    "LICENSE",
    "main.html",
    "manifest.webmanifest",
    "polyfill/chrome_polyfills.js",
    "polyfill/IndexedDB-getAll-shim.js",
    "style/confirm.css",
    "style/drawer/images/icons/menu.png",
    "style/drawer/images/icons/menu@1.5x.png",
    "style/drawer/images/icons/menu@2.25x.png",
    "style/drawer/images/icons/menu@2x.png",
    "style/drawer/images/ui/header/header.png",
    "style/drawer/images/ui/header/shadow.png",
    "style/drawer/images/ui/header/shadow@1.5x.png",
    "style/drawer/images/ui/header/shadow@2x.png",
    "style/drawer/images/ui/header.png",
    "style/drawer/images/ui/negative.png",
    "style/drawer/images/ui/pattern.png",
    "style/drawer/images/ui/pattern_subheader.png",
    "style/drawer/images/ui/separator.png",
    "style/drawer/images/ui/separator_large.png",
    "style/drawer/images/ui/shadow.png",
    "style/drawer/images/ui/shadow@1.5x.png",
    "style/drawer/images/ui/shadow@2x.png",
    "style/drawer/images/ui/shadow_header.png",
    "style/drawer/images/ui/shadow_header@1.5x.png",
    "style/drawer/images/ui/shadow_header@2x.png",
    "style/drawer/images/ui/shadow_rtl.png",
    "style/drawer/images/ui/shadow_rtl@1.5x.png",
    "style/drawer/images/ui/shadow_rtl@2x.png",
    "style/drawer.css",
    "style/emoji/emoji0.png",
    "style/emoji/emoji1.png",
    "style/emoji/emoji2.png",
    "style/emoji/emoji3.png",
    "style/emoji/emoji4.png",
    "style/emoji/emoji5.png",
    "style/emoji/emoji6.png",
    "style/emoji/emoji7.png",
    "style/emoji/emoji8.png",
    "style/emoji/emoji9.png",
    "style/emoji/emojia.png",
    "style/emoji/emojic.png",
    "style/emoji/LICENSE",
    "style/headers/images/icons/add.png",
    "style/headers/images/icons/add@1.5x.png",
    "style/headers/images/icons/add@2.25x.png",
    "style/headers/images/icons/add@2x.png",
    "style/headers/images/icons/back-rtl.png",
    "style/headers/images/icons/back-rtl@1.5x.png",
    "style/headers/images/icons/back-rtl@2.25x.png",
    "style/headers/images/icons/back-rtl@2x.png",
    "style/headers/images/icons/back.png",
    "style/headers/images/icons/back.svg",
    "style/headers/images/icons/back@1.5x.png",
    "style/headers/images/icons/back@2.25x.png",
    "style/headers/images/icons/back@2x.png",
    "style/headers/images/icons/back_rtl.png",
    "style/headers/images/icons/back_rtl@1.5x.png",
    "style/headers/images/icons/clear.png",
    "style/headers/images/icons/clear@1.5x.png",
    "style/headers/images/icons/clear@2x.png",
    "style/headers/images/icons/close.png",
    "style/headers/images/icons/close.svg",
    "style/headers/images/icons/close@1.5x.png",
    "style/headers/images/icons/close@2.25x.png",
    "style/headers/images/icons/close@2x.png",
    "style/headers/images/icons/compose.png",
    "style/headers/images/icons/compose@1.5x.png",
    "style/headers/images/icons/compose@2.25x.png",
    "style/headers/images/icons/compose@2x.png",
    "style/headers/images/icons/down.png",
    "style/headers/images/icons/down@1.5x.png",
    "style/headers/images/icons/down@2.25x.png",
    "style/headers/images/icons/down@2x.png",
    "style/headers/images/icons/edit.png",
    "style/headers/images/icons/edit@1.5x.png",
    "style/headers/images/icons/edit@2.25x.png",
    "style/headers/images/icons/edit@2x.png",
    "style/headers/images/icons/menu.png",
    "style/headers/images/icons/menu.svg",
    "style/headers/images/icons/menu@1.5x.png",
    "style/headers/images/icons/menu@2.25x.png",
    "style/headers/images/icons/menu@2x.png",
    "style/headers/images/icons/options.png",
    "style/headers/images/icons/options@1.5x.png",
    "style/headers/images/icons/options@2.25x.png",
    "style/headers/images/icons/options@2x.png",
    "style/headers/images/icons/organic/add.png",
    "style/headers/images/icons/organic/add@1.5.png",
    "style/headers/images/icons/organic/add@1.5x.png",
    "style/headers/images/icons/organic/add@2.25x.png",
    "style/headers/images/icons/organic/add@2x.png",
    "style/headers/images/icons/organic/back-rtl@2.25x.png",
    "style/headers/images/icons/organic/back.png",
    "style/headers/images/icons/organic/back.svg",
    "style/headers/images/icons/organic/back@1.5x.png",
    "style/headers/images/icons/organic/back@2.25x.png",
    "style/headers/images/icons/organic/back@2x.png",
    "style/headers/images/icons/organic/back_rtl.png",
    "style/headers/images/icons/organic/back_rtl@1.5x.png",
    "style/headers/images/icons/organic/close.png",
    "style/headers/images/icons/organic/close.svg",
    "style/headers/images/icons/organic/close@1.5x.png",
    "style/headers/images/icons/organic/close@2.25x.png",
    "style/headers/images/icons/organic/close@2x.png",
    "style/headers/images/icons/organic/edit.png",
    "style/headers/images/icons/organic/edit@1.5x.png",
    "style/headers/images/icons/organic/edit@2.25x.png",
    "style/headers/images/icons/organic/edit@2x.png",
    "style/headers/images/icons/reply-all.png",
    "style/headers/images/icons/reply-all@1.5x.png",
    "style/headers/images/icons/reply-all@2x.png",
    "style/headers/images/icons/reply.png",
    "style/headers/images/icons/reply.png@2.25x.png",
    "style/headers/images/icons/reply@1.5x.png",
    "style/headers/images/icons/reply@2.25x.png",
    "style/headers/images/icons/reply@2x.png",
    "style/headers/images/icons/reply_all.png",
    "style/headers/images/icons/reply_all@1.5x.png",
    "style/headers/images/icons/reply_all@2.25x.png",
    "style/headers/images/icons/reply_all@2x.png",
    "style/headers/images/icons/send.png",
    "style/headers/images/icons/send@1.5x.png",
    "style/headers/images/icons/send@2.25x.png",
    "style/headers/images/icons/send@2x.png",
    "style/headers/images/icons/up.png",
    "style/headers/images/icons/up@1.5x.png",
    "style/headers/images/icons/up@2.25x.png",
    "style/headers/images/icons/up@2x.png",
    "style/headers/images/icons/user.png",
    "style/headers/images/icons/user@1.5x.png",
    "style/headers/images/icons/user@2.25x.png",
    "style/headers/images/icons/user@2x.png",
    "style/headers/images/ui/dark/header.png",
    "style/headers/images/ui/dark/negative.png",
    "style/headers/images/ui/dark/separator-large.png",
    "style/headers/images/ui/dark/separator.png",
    "style/headers/images/ui/dark/separator@1.5x.png",
    "style/headers/images/ui/dark/subheader.png",
    "style/headers/images/ui/header.png",
    "style/headers/images/ui/noise-pattern.png",
    "style/headers/images/ui/organic/header.png",
    "style/headers/images/ui/organic/negative.png",
    "style/headers/images/ui/organic/pattern.png",
    "style/headers/images/ui/organic/separator-large.png",
    "style/headers/images/ui/organic/separator.png",
    "style/headers/images/ui/organic/subheader.png",
    "style/headers/images/ui/overlay/header.png",
    "style/headers/images/ui/overlay/separator.png",
    "style/headers/images/ui/separator-large.png",
    "style/headers/images/ui/separator.png",
    "style/headers/images/ui/shadow.png",
    "style/headers/images/ui/shadow@1.5x.png",
    "style/headers/images/ui/shadow@2x.png",
    "style/headers/images/ui/subheader.png",
    "style/headers.css",
    "style/index.css",
    "style/main.css",
    "style/progress_activity/images/ui/activity.png",
    "style/progress_activity/images/ui/activity@1.5x.png",
    "style/progress_activity/images/ui/activity@2.25x.png",
    "style/progress_activity/images/ui/activity@2x.png",
    "style/progress_activity/images/ui/default.png",
    "style/progress_activity/images/ui/default@1.5x.png",
    "style/progress_activity/images/ui/default@2.25x.png",
    "style/progress_activity/images/ui/default@2x.png",
    "style/progress_activity/images/ui/light.png",
    "style/progress_activity/images/ui/light@1.5x.png",
    "style/progress_activity/images/ui/light@2.25x.png",
    "style/progress_activity/images/ui/light@2x.png",
    "style/progress_activity.css",
    "timer.js",
    "updatelog.html"
];

// Install Event: Cache all found files
self.addEventListener('install', (event) => {
  event.waitUntil(
    caches.open(CACHE_NAME).then((cache) => {
      console.log('Opened cache and adding assets');
      return cache.addAll(ASSETS_TO_CACHE);
    })
  );
});

// Activate Event: Cleanup old caches
self.addEventListener('activate', (event) => {
  event.waitUntil(
    caches.keys().then((cacheNames) => {
      return Promise.all(
        cacheNames.map((cache) => {
          if (cache !== CACHE_NAME) {
            console.log('Clearing old cache:', cache);
            return caches.delete(cache);
          }
        })
      );
    })
  );
});

// Fetch Event: Serve from cache, fallback to network
self.addEventListener('fetch', (event) => {
  event.respondWith(
    caches.match(event.request).then((response) => {
      return response || fetch(event.request);
    })
  );
});